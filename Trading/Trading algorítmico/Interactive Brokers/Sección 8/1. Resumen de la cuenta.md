### **Resumen: Obtener Resumen de la Cuenta en Interactive Brokers**

Esta lecci贸n ense帽a c贸mo conectarse a la API de **Interactive Brokers (IB)** usando Python para **obtener el resumen general de la cuenta**.  
Se utiliza el m茅todo `reqAccountSummary` para solicitar informaci贸n como el tipo de cuenta, el valor neto de liquidaci贸n, el efectivo total disponible y otros datos relevantes.  

El flujo b谩sico es:
1. **Conectarse** a la API de IB usando `EClient` y `EWrapper`.
2. **Solicitar** el resumen de la cuenta especificando las etiquetas (`tags`) deseadas.
3. **Almacenar y mostrar** la informaci贸n recibida.
4. **Cancelar la suscripci贸n** para detener el flujo continuo de actualizaciones.
5. **Solicitar otros conjuntos de datos** repitiendo el proceso.

>  **Importante:** Algunas solicitudes como `reqAccountSummary` env铆an actualizaciones continuas hasta que se cancele la suscripci贸n con `cancelAccountSummary`.

---

### **El Bloque de C贸digo Clave**

Este ejemplo muestra c贸mo:
- Crear una clase que hereda de `EWrapper` y `EClient`.
- Implementar los m茅todos `accountSummary` y `accountSummaryEnd` para recibir y manejar los datos.
- Usar `threading.Event()` para sincronizar la recepci贸n de datos antes de continuar.
- Cancelar la suscripci贸n para optimizar recursos.

```python
# -*- coding: utf-8 -*-
from ibapi.client import EClient
from ibapi.wrapper import EWrapper
import threading
import time

# Clase que obtiene el Resumen de la Cuenta
class IB_CuentaResumen(EWrapper, EClient):
    def __init__(self):
        EClient.__init__(self, self)
        self.cuenta_resumen = []       # Lista para almacenar los datos recibidos
        self.cuenta_evento = threading.Event()  # Evento para sincronizar la recepci贸n

    def nextValidId(self, orderId):
        self.next_order_id = orderId

    def accountSummary(self, reqId, account, tag, value, currency):
        # Imprimir y almacenar los datos recibidos
        print(f"Cuenta: {account}, Etiqueta: {tag}, Valor: {value}, Moneda: 
	    {currency}")
        self.cuenta_resumen.append((account, tag, value, currency))

    def accountSummaryEnd(self, reqId):
        # Indicar que ya se recibi贸 todo el resumen solicitado
        print("Se recibi贸 el resumen completo de la cuenta")
        self.cuenta_evento.set()

# Conexi贸n a IB
IB_conn = IB_CuentaResumen()
IB_conn.connect(host="127.0.0.1", port=7497, clientId=1)
api_thread = threading.Thread(target=IB_conn.run)
api_thread.start()
time.sleep(3)

# 1. Solicitar resumen con variables clave
IB_conn.reqAccountSummary(1, "All", "AccountType,NetLiquidation,TotalCashValue")
IB_conn.cuenta_evento.wait()
IB_conn.cancelAccountSummary(1)

# 2. Solicitar resumen del libro contable en USD
IB_conn.cuenta_evento.clear()
IB_conn.reqAccountSummary(1, "All", "$LEDGER:USD")
IB_conn.cuenta_evento.wait()
IB_conn.cancelAccountSummary(1)

# Desconectar
IB_conn.disconnect()
api_thread.join()

# Nota:
# - reqAccountSummary env铆a actualizaciones continuas.
# - Siempre cancelar la suscripci贸n cuando ya no se necesiten los datos.
